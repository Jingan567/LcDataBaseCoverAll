<!DOCTYPE html>
<!-- saved from url=(0116)file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_conflict.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="./lang_conflict_files/sqlite.css" rel="stylesheet">
<title _msttexthash="10303865" _msthash="0">ON CONFLICT 子句</title>
<!-- path= -->
</head>
<body>
<div class="nosearch">
<a href="https://www.sqlite.org/index.html">
<img class="logo" src="./lang_conflict_files/sqlite370_banner.gif" alt="SQLite" border="0" _mstalt="70863" _msthash="1">
</a>
<div><!-- IE hack to prevent disappearing logo --></div>
<div class="tagline desktoponly" _msttexthash="53246063" _msthash="2">小。快。可靠。<br _istranslated="1">选择任意三个。</div>
<div class="menu mainmenu">
<ul>
<li><a href="https://www.sqlite.org/index.html" _msttexthash="2136498" _msthash="3">家</a>
</li><li class="mobileonly" _msthidden="1"><a href="https://www.sqlite.org/javascript:void(0)" onclick="toggle_div(&quot;submenu&quot;)" _msttexthash="45591" _msthidden="1" _msthash="4">Menu</a>
</li><li class="wideonly"><a href="https://www.sqlite.org/about.html" _msttexthash="5448781" _msthash="5">大约</a>
</li><li class="desktoponly"><a href="https://www.sqlite.org/docs.html" _msttexthash="5144373" _msthash="6">文档</a>
</li><li class="desktoponly"><a href="https://www.sqlite.org/download.html" _msttexthash="5638321" _msthash="7">下载</a>
</li><li class="wideonly"><a href="https://www.sqlite.org/copyright.html" _msttexthash="9675445" _msthash="8">许可证</a>
</li><li class="desktoponly"><a href="https://www.sqlite.org/support.html" _msttexthash="4993053" _msthash="9">支持</a>
</li><li class="desktoponly"><a href="https://www.sqlite.org/prosupport.html" _msttexthash="5377151" _msthash="10">购买</a>
</li><li class="search" id="search_menubutton" _msthidden="1" style="display: none;">
<a href="https://www.sqlite.org/javascript:void(0)" onclick="toggle_search()" _msttexthash="74607" _msthidden="1" _msthash="11">Search</a>
</li></ul>
</div>
<div class="menu submenu" id="submenu" _msthidden="5">
<ul _msthidden="5">
<li _msthidden="1"><a href="https://www.sqlite.org/about.html" _msttexthash="60892" _msthidden="1" _msthash="12">About</a>
</li><li _msthidden="1"><a href="https://www.sqlite.org/docs.html" _msttexthash="234962" _msthidden="1" _msthash="13">Documentation</a>
</li><li _msthidden="1"><a href="https://www.sqlite.org/download.html" _msttexthash="113308" _msthidden="1" _msthash="14">Download</a>
</li><li _msthidden="1"><a href="https://www.sqlite.org/support.html" _msttexthash="100646" _msthidden="1" _msthash="15">Support</a>
</li><li _msthidden="1"><a href="https://www.sqlite.org/prosupport.html" _msttexthash="113477" _msthidden="1" _msthash="16">Purchase</a>
</li></ul>
</div>
<div class="searchmenu" id="searchmenu" _msthidden="3">
<form method="GET" action="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/search" _msthidden="3">
<select name="s" id="searchtype" _msthidden="2">
<option value="d" _msttexthash="416429" _msthidden="1" _msthash="17">Search Documentation</option>
<option value="c" _msttexthash="276705" _msthidden="1" _msthash="18">Search Changelog</option>
</select>
<input type="text" name="q" id="searchbox" value="">
<input type="submit" value="Go" _msthidden="A" _mstvalue="18005" _msthash="19">
</form>
</div>
</div>
<script>
function toggle_div(nm) {
var w = document.getElementById(nm);
if( w.style.display=="block" ){
w.style.display = "none";
}else{
w.style.display = "block";
}
}
function toggle_search() {
var w = document.getElementById("searchmenu");
if( w.style.display=="block" ){
w.style.display = "none";
} else {
w.style.display = "block";
setTimeout(function(){
document.getElementById("searchbox").focus()
}, 30);
}
}
function div_off(nm){document.getElementById(nm).style.display="none";}
window.onbeforeunload = function(e){div_off("submenu");}
/* Disable the Search feature if we are not operating from CGI, since */
/* Search is accomplished using CGI and will not work without it. */
if( !location.origin || 1 ){
document.getElementById("search_menubutton").style.display = "none";
}
/* Used by the Hide/Show button beside syntax diagrams, to toggle the */
function hideorshow(btn,obj){
var x = document.getElementById(obj);
var b = document.getElementById(btn);
if( x.style.display!='none' ){
x.style.display = 'none';
b.innerHTML='show';
}else{
x.style.display = '';
b.innerHTML='hide';
}
return false;
}

</script>
<div class="fancy">
<div class="nosearch">
<div class="fancy_title" _msttexthash="10303865" _msthash="20">ON CONFLICT 子句</div>
</div>




<p><b><a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/syntax/conflict-clause.html" _msttexthash="25528867" _msthash="21">conflict-clause 中：</a></b>
<button id="x91fb97ac" onclick="hideorshow(&quot;x91fb97ac&quot;,&quot;xe68f90d9&quot;)" _msttexthash="7070024" _msthash="22">隐藏</button></p>
 <div id="xe68f90d9" class="imgcontainer">
 <div style="max-width:451px"><svg xmlns="http://www.w3.org/2000/svg" class="pikchr" viewBox="0 0 451.517 205.2" width="451.517" height="205.2">
<circle cx="5" cy="6" r="3.6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></circle>
<polygon points="32,6 20,10 20,2" style="fill:rgb(0,0,0)"></polygon>
<path d="M9,6L26,6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="70,36 58,41 58,32" style="fill:rgb(0,0,0)"></polygon>
<path d="M32,6 L 39,6 Q 47,6 47,21 L 47,21 Q 47,36 56,36 L 64,36" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M85,51L94,51A15 15 0 0 0 109 36L109,36A15 15 0 0 0 94 21L85,21A15 15 0 0 0 70 36L70,36A15 15 0 0 0 85 51Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="90" y="36" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstTextHash="1817998" _mstHash="23">上</text>
<polygon points="132,36 121,41 121,32" style="fill:rgb(0,0,0)"></polygon>
<path d="M109,36L126,36" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M147,51L222,51A15 15 0 0 0 237 36L237,36A15 15 0 0 0 222 21L147,21A15 15 0 0 0 132 36L132,36A15 15 0 0 0 147 51Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="184" y="36" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstTextHash="5164718" _mstHash="24">冲突</text>
<polygon points="273,36 261,41 261,32" style="fill:rgb(0,0,0)"></polygon>
<path d="M237,36L267,36" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M288,51L365,51A15 15 0 0 0 381 36L381,36A15 15 0 0 0 365 21L288,21A15 15 0 0 0 273 36L273,36A15 15 0 0 0 288 51Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="327" y="36" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstTextHash="5770687" _mstHash="25">反转</text>
<path d="M288,89L330,89A15 15 0 0 0 345 74L345,74A15 15 0 0 0 330 59L288,59A15 15 0 0 0 273 74L273,74A15 15 0 0 0 288 89Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="309" y="74" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstTextHash="4639219" _mstHash="26">流产</text>
<path d="M288,127L310,127A15 15 0 0 0 325 112A15 15 0 0 0 310 97L288,97A15 15 0 0 0 273 112A15 15 0 0 0 288 127Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="299" y="112" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstTextHash="5835635" _mstHash="27">失败</text>
<path d="M288,165L340,165A15 15 0 0 0 355 150A15 15 0 0 0 340 135L288,135A15 15 0 0 0 273 150A15 15 0 0 0 288 165Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="314" y="150" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstTextHash="5904223" _mstHash="28">忽视</text>
<path d="M288,203L352,203A15 15 0 0 0 367 187A15 15 0 0 0 352 172L288,172A15 15 0 0 0 273 187A15 15 0 0 0 288 203Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="320" y="187" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstTextHash="4053322" _mstHash="29">取代</text>
<polygon points="404,36 392,41 392,32" style="fill:rgb(0,0,0)"></polygon>
<path d="M381,36L398,36" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="442,6 430,10 430,2" style="fill:rgb(0,0,0)"></polygon>
<path d="M404,36 L 411,36 Q 419,36 419,21 L 419,21 Q 419,6 427,6 L 436,6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<circle cx="445" cy="6" r="3.6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></circle>
<polygon points="225,6 214,10 214,2" style="fill:rgb(0,0,0)"></polygon>
<path d="M9,6L219,6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M225,6L434,6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="273,187 261,192 261,183" style="fill:rgb(0,0,0)"></polygon>
<path d="M237,36 L 244,36 Q 252,36 252,51 L 252,172 Q 252,187 259,187 L 267,187" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="404,187 392,192 392,183" style="fill:rgb(0,0,0)"></polygon>
<path d="M367,187L398,187" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M404,187 L 411,187 Q 419,187 419,172 L 419,36 L 419,21" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="273,74 261,78 261,70" style="fill:rgb(0,0,0)"></polygon>
<path d="M252,59 L 252,66 Q 252,74 259,74 L 267,74" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="404,74 392,78 392,70" style="fill:rgb(0,0,0)"></polygon>
<path d="M345,74L398,74" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M404,74 L 411,74 Q 419,74 419,67 L 419,59" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="273,112 261,116 261,108" style="fill:rgb(0,0,0)"></polygon>
<path d="M252,97 L 252,104 Q 252,112 259,112 L 267,112" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="404,112 392,116 392,108" style="fill:rgb(0,0,0)"></polygon>
<path d="M325,112L398,112" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M404,112 L 411,112 Q 419,112 419,104 L 419,97" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="273,150 261,154 261,145" style="fill:rgb(0,0,0)"></polygon>
<path d="M252,135 L 252,142 Q 252,150 259,150 L 267,150" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="404,150 392,154 392,145" style="fill:rgb(0,0,0)"></polygon>
<path d="M355,150L398,150" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M404,150 L 411,150 Q 419,150 419,142 L 419,135" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
</svg>
</div>
</div>


<p _msttexthash="1179523319" _msthash="30">ON CONFLICT 子句是一个
特定于 SQLite 的非标准扩展
这可能出现在许多其他 SQL 命令中。
它在本文档中有自己的部分，因为它不是
是标准 SQL 的一部分，因此可能不熟悉。</p>

<p _msttexthash="1837251455" _msthash="31">此处描述的 ON CONFLICT 子句是
SQLite 从 3.0.0 版本开始 （2004-06-18）。短语
“ON CONFLICT” 也是 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_upsert.html" _istranslated="1">UPSERT 的一部分，UPSERT</a> 是一个扩展
添加到版本 3.24.0 （2018-06-04） 中的 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_insert.html" _istranslated="1">INSERT</a>。不要
混淆了 “ON CONFLICT” 短语的这两个单独用法。</p><p _msttexthash="2635686339" _msthash="32">ON CONFLICT 子句的语法如上所示，其中
CREATE TABLE 命令。对于 INSERT 和
UPDATE 命令，则关键字 “ON CONFLICT” 将替换为 “OR” ，以便
语法读起来更自然。例如，而不是
“INSERT ON CONFLICT IGNORE” 我们有 “INSERT OR IGNORE”。
关键字会发生变化，但子句的含义相同
无论哪种方式。</p>

<p _msttexthash="1889171089" _msthash="33">ON CONFLICT 子句适用于 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_createtable.html#uniqueconst" _istranslated="1">UNIQUE</a>、<a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_createtable.html#notnullconst" _istranslated="1">NOT NULL、</a><a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_createtable.html#ckconst" _istranslated="1">CHECK</a> 和 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_createtable.html#primkeyconst" _istranslated="1">PRIMARY KEY</a> 约束。
ON CONFLICT 算法不会
apply to <a href="https://www.sqlite.org/foreignkeys.html" _istranslated="1">FOREIGN KEY 约束</a>。
有五种冲突解决算法选项：
ROLLBACK、ABORT、FAIL、IGNORE 和 REPLACE。
默认冲突解决算法为 ABORT。这
是他们的意思：</p>

<dl>
<dt><b _msttexthash="5770687" _msthash="34">反转</b></dt>
<dd><p _msttexthash="1712684519" _msthash="35">当发生适用的约束冲突时，ROLLBACK
resolution 算法中止当前 SQL 语句，其中包含
SQLITE_CONSTRAINT错误并回滚当前事务。
如果没有事务是
active （除了在每个
命令），则 ROLLBACK 解析算法的工作方式与
ABORT 算法。</p></dd>

<dt><b _msttexthash="4639219" _msthash="36">流产</b></dt>
<dd><p _msttexthash="1965333864" _msthash="37">当发生适用的约束冲突时，ABORT
resolution 算法中止当前 SQL 语句
SQLITE_CONSTRAINT错误并回退任何更改
由当前 SQL 语句制作;但更改导致
by prior SQL 语句，并且
事务保持活动状态。
这是默认行为，也是 SQL 指定的行为
标准。</p></dd>

<dt><b _msttexthash="5835635" _msthash="38">失败</b></dt>
<dd><p _msttexthash="3679582439" _msthash="39">当发生适用的约束冲突时，FAIL
resolution 算法中止当前 SQL 语句，并使用
SQLITE_CONSTRAINT错误。但 FAIL 解决方案不会
回退失败的 SQL 语句的先前更改，也不会
它结束了交易。
例如，如果 UPDATE
语句在第 100 行遇到约束冲突，该
它尝试更新，然后保留前 99 行更改
但对第 100 行及以后的行从未发生更改。</p>

<p _msttexthash="228315841" _msthash="40">FAIL 行为仅适用于唯一性、NOT NULL 和 CHECK
约束。<a href="https://www.sqlite.org/foreignkeys.html" _istranslated="1">外键约束</a>冲突会导致 ABORT。</p></dd>

<dt><b _msttexthash="5904223" _msthash="41">忽视</b></dt>
<dd><p _msttexthash="3495325951" _msthash="42">发生适用的约束冲突时，
IGNORE 解析算法跳过包含
约束冲突并继续处理后续行
的 SQL 语句中，就好像没有出错一样。
该行之前和之后的其他行
包含约束冲突的
通常。唯一性、NOT NULL 和
当 IGNORE 冲突解决时出现 UNIQUE 约束错误
algorithm 的 intent 语句。但是，IGNORE 冲突解决方法
算法的工作方式类似于 ABORT 处理<a href="https://www.sqlite.org/foreignkeys.html" _istranslated="1">外键约束</a>错误。</p>
</dd>

<dt><b _msttexthash="4053322" _msthash="43">取代</b></dt>
<dd><p _msttexthash="4590206127" _msthash="44">当发生 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_createtable.html#uniqueconst" _istranslated="1">UNIQUE</a> 或 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_createtable.html#primkeyconst" _istranslated="1">PRIMARY KEY</a> 约束冲突时，
REPLACE 算法
删除导致约束冲突的预先存在的行
在插入或更新当前行之前，命令继续
正常执行。
如果发生 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_createtable.html#notnullconst" _istranslated="1">NOT NULL</a> 约束冲突，则 REPLACE 冲突
resolution 将 NULL 值替换为
该列的默认值，或者该列没有默认值
值，则使用 ABORT 算法。
如果发生 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_createtable.html#ckconst" _istranslated="1">CHECK 约束</a>或<a href="https://www.sqlite.org/foreignkeys.html" _istranslated="1">外键约束</a>冲突，
REPLACE 冲突解决算法的工作方式与 ABORT 类似。</p>

<p _msttexthash="477614475" _msthash="45">当 REPLACE 冲突解决策略删除行以
满足约束条件，当且仅当启用<a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/pragma.html#pragma_recursive_triggers" _istranslated="1">递归触发器</a>时，<a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_createtrigger.html" _istranslated="1">才会触发 DELETE 触发器</a>。</p>

<p _msttexthash="1047464067" _msthash="46">对于符合以下条件的行，不会调用 <a href="https://www.sqlite.org/c3ref/update_hook.html" _istranslated="1">update 钩子</a>
将被 REPLACE 冲突解决策略删除。也没有
REPLACE 增加<a href="https://www.sqlite.org/c3ref/changes.html" _istranslated="1">更改计数器</a>。
本段中定义的异常行为可能会发生变化
在未来版本中。</p>
</dd></dl>

<p _msttexthash="731629951" _msthash="47">在 INSERT 或 UPDATE 的 OR 子句中指定的算法
覆盖 CREATE TABLE 中指定的任何算法。
如果在任何地方都没有指定算法，则使用 ABORT 算法。</p>


</div></body></html>