<!DOCTYPE html>
<!-- saved from url=(0119)file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_transaction.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="./lang_transaction_files/sqlite.css" rel="stylesheet">
<title _msttexthash="4549636" _msthash="71">交易</title>
<!-- path= -->
</head>
<body>
<div class="nosearch">
<a href="https://www.sqlite.org/index.html">
<img class="logo" src="./lang_transaction_files/sqlite370_banner.gif" alt="SQLite" border="0" _mstalt="70863">
</a>
<div><!-- IE hack to prevent disappearing logo --></div>
<div class="tagline desktoponly" _msttexthash="53246063" _msthash="72">小。快。可靠。<br _istranslated="1">选择任意三个。</div>
<div class="menu mainmenu">
<ul>
<li><a href="https://www.sqlite.org/index.html" _msttexthash="2136498" _msthash="73">家</a>
</li><li class="mobileonly" _msthidden="1"><a href="https://www.sqlite.org/javascript:void(0)" onclick="toggle_div(&quot;submenu&quot;)" _msttexthash="45591" _msthidden="1" _msthash="74">Menu</a>
</li><li class="wideonly"><a href="https://www.sqlite.org/about.html" _msttexthash="5448781" _msthash="75">大约</a>
</li><li class="desktoponly"><a href="https://www.sqlite.org/docs.html" _msttexthash="5144373" _msthash="76">文档</a>
</li><li class="desktoponly"><a href="https://www.sqlite.org/download.html" _msttexthash="5638321" _msthash="77">下载</a>
</li><li class="wideonly"><a href="https://www.sqlite.org/copyright.html" _msttexthash="9675445" _msthash="78">许可证</a>
</li><li class="desktoponly"><a href="https://www.sqlite.org/support.html" _msttexthash="4993053" _msthash="79">支持</a>
</li><li class="desktoponly"><a href="https://www.sqlite.org/prosupport.html" _msttexthash="5377151" _msthash="80">购买</a>
</li><li class="search" id="search_menubutton" _msthidden="1" style="display: none;">
<a href="https://www.sqlite.org/javascript:void(0)" onclick="toggle_search()" _msttexthash="74607" _msthidden="1" _msthash="81">Search</a>
</li></ul>
</div>
<div class="menu submenu" id="submenu" _msthidden="5">
<ul _msthidden="5">
<li _msthidden="1"><a href="https://www.sqlite.org/about.html" _msttexthash="60892" _msthidden="1" _msthash="82">About</a>
</li><li _msthidden="1"><a href="https://www.sqlite.org/docs.html" _msttexthash="234962" _msthidden="1" _msthash="83">Documentation</a>
</li><li _msthidden="1"><a href="https://www.sqlite.org/download.html" _msttexthash="113308" _msthidden="1" _msthash="84">Download</a>
</li><li _msthidden="1"><a href="https://www.sqlite.org/support.html" _msttexthash="100646" _msthidden="1" _msthash="85">Support</a>
</li><li _msthidden="1"><a href="https://www.sqlite.org/prosupport.html" _msttexthash="113477" _msthidden="1" _msthash="86">Purchase</a>
</li></ul>
</div>
<div class="searchmenu" id="searchmenu" _msthidden="3">
<form method="GET" action="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/search" _msthidden="3">
<select name="s" id="searchtype" _msthidden="2">
<option value="d" _msttexthash="416429" _msthidden="1" _msthash="87">Search Documentation</option>
<option value="c" _msttexthash="276705" _msthidden="1" _msthash="88">Search Changelog</option>
</select>
<input type="text" name="q" id="searchbox" value="">
<input type="submit" value="Go" _mstvalue="18005" _msthidden="A">
</form>
</div>
</div>
<script>
function toggle_div(nm) {
var w = document.getElementById(nm);
if( w.style.display=="block" ){
w.style.display = "none";
}else{
w.style.display = "block";
}
}
function toggle_search() {
var w = document.getElementById("searchmenu");
if( w.style.display=="block" ){
w.style.display = "none";
} else {
w.style.display = "block";
setTimeout(function(){
document.getElementById("searchbox").focus()
}, 30);
}
}
function div_off(nm){document.getElementById(nm).style.display="none";}
window.onbeforeunload = function(e){div_off("submenu");}
/* Disable the Search feature if we are not operating from CGI, since */
/* Search is accomplished using CGI and will not work without it. */
if( !location.origin || 1 ){
document.getElementById("search_menubutton").style.display = "none";
}
/* Used by the Hide/Show button beside syntax diagrams, to toggle the */
function hideorshow(btn,obj){
var x = document.getElementById(obj);
var b = document.getElementById(btn);
if( x.style.display!='none' ){
x.style.display = 'none';
b.innerHTML='show';
}else{
x.style.display = '';
b.innerHTML='hide';
}
return false;
}

</script>
<div class="fancy">
<div class="nosearch">
<div class="fancy_title" _msttexthash="4549636" _msthash="89">交易</div>
</div>




<h1 id="transaction_control_syntax" _msttexthash="23167352" _msthash="90"><span _istranslated="1">1. </span>事务控制语法</h1>

<p><b><a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/syntax/begin-stmt.html" _msttexthash="19858280" _msthash="91">begin-stmt 中：</a></b>
<button id="xb1701bb4" onclick="hideorshow(&quot;xb1701bb4&quot;,&quot;x4999ba07&quot;)" _msttexthash="7070024" _msthash="92">隐藏</button></p>
 <div id="x4999ba07" class="imgcontainer">
 <div style="max-width:560px"><svg xmlns="http://www.w3.org/2000/svg" class="pikchr" viewBox="0 0 560.669 140.4" width="560.669" height="140.4">
<circle cx="5" cy="17" r="3.6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></circle>
<polygon points="32,17 20,21 20,12" style="fill:rgb(0,0,0)"></polygon>
<path d="M9,17L26,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M47,32L86,32A15 15 0 0 0 101 17A15 15 0 0 0 86 2L47,2A15 15 0 0 0 32 17A15 15 0 0 0 47 32Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="66" y="17" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="24" _mstTextHash="4603768">开始</text>
<polygon points="124,17 112,21 112,12" style="fill:rgb(0,0,0)"></polygon>
<path d="M101,17L118,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="162,123 150,127 150,118" style="fill:rgb(0,0,0)"></polygon>
<path d="M124,17 L 131,17 Q 139,17 139,32 L 139,108 Q 139,123 147,123 L 156,123" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M177,138L261,138A15 15 0 0 0 276 123A15 15 0 0 0 261 108L177,108A15 15 0 0 0 162 123A15 15 0 0 0 177 138Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="219" y="123" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="25" _mstTextHash="5118932">独家</text>
<polygon points="299,123 287,127 287,118" style="fill:rgb(0,0,0)"></polygon>
<path d="M276,123L293,123" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="337,17 325,21 325,12" style="fill:rgb(0,0,0)"></polygon>
<path d="M299,123 L 306,123 Q 314,123 314,108 L 314,32 Q 314,17 322,17 L 331,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="373,17 361,21 361,12" style="fill:rgb(0,0,0)"></polygon>
<path d="M337,17L367,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M388,32L500,32A15 15 0 0 0 515 17A15 15 0 0 0 500 2L388,2A15 15 0 0 0 373 17A15 15 0 0 0 388 32Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="444" y="17" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="26" _mstTextHash="4549636">交易</text>
<polygon points="551,17 539,21 539,12" style="fill:rgb(0,0,0)"></polygon>
<path d="M515,17L545,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<circle cx="554" cy="17" r="3.6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></circle>
<polygon points="444,47 432,51 432,43" style="fill:rgb(0,0,0)"></polygon>
<path d="M337,17 L 344,17 Q 352,17 352,32 L 352,32 Q 352,47 367,47 L 423,47 L 438,47" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M444,47 L 511,47 Q 526,47 526,32 L 526,32 Q 526,17 533,17 L 541,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M124,17L325,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="162,47 150,51 150,43" style="fill:rgb(0,0,0)"></polygon>
<path d="M139,32 L 139,39 Q 139,47 147,47 L 156,47" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M177,62L257,62A15 15 0 0 0 272 47L272,47A15 15 0 0 0 257 32L177,32A15 15 0 0 0 162 47L162,47A15 15 0 0 0 177 62Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="217" y="47" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="27" _mstTextHash="5884502">递 延</text>
<polygon points="295,47 284,51 284,43" style="fill:rgb(0,0,0)"></polygon>
<path d="M272,47L289,47" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M295,47 L 304,47 Q 314,47 314,40 L 314,32" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="162,85 150,89 150,81" style="fill:rgb(0,0,0)"></polygon>
<path d="M139,32 L 139,70 Q 139,85 147,85 L 156,85" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M177,100L265,100A15 15 0 0 0 281 85A15 15 0 0 0 265 70L177,70A15 15 0 0 0 162 85A15 15 0 0 0 177 100Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="221" y="85" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="28" _mstTextHash="8632117">立即的</text>
<polygon points="304,85 292,89 292,81" style="fill:rgb(0,0,0)"></polygon>
<path d="M281,85L298,85" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M304,85 L 309,85 Q 314,85 314,77 L 314,70" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
</svg>
</div>
</div>
<p><b><a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/syntax/commit-stmt.html" _msttexthash="20993674" _msthash="93">commit-stmt 中：</a></b>
<button id="x4ef3720b" onclick="hideorshow(&quot;x4ef3720b&quot;,&quot;x9d6c8324&quot;)" _msttexthash="7070024" _msthash="94">隐藏</button></p>
 <div id="x9d6c8324" class="imgcontainer">
 <div style="max-width:434px"><svg xmlns="http://www.w3.org/2000/svg" class="pikchr" viewBox="0 0 434.506 72.36" width="434.506" height="72.36">
<circle cx="5" cy="17" r="3.6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></circle>
<polygon points="32,17 20,21 20,12" style="fill:rgb(0,0,0)"></polygon>
<path d="M9,17L26,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="68,17 56,21 56,12" style="fill:rgb(0,0,0)"></polygon>
<path d="M32,17L62,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M83,32L141,32A15 15 0 0 0 157 17A15 15 0 0 0 141 2L83,2A15 15 0 0 0 68 17A15 15 0 0 0 83 32Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="112" y="17" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="31" _mstTextHash="2671669">犯</text>
<polygon points="202,17 190,21 190,12" style="fill:rgb(0,0,0)"></polygon>
<path d="M157,17L196,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M202,17L238,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M253,32L365,32A15 15 0 0 0 380 17A15 15 0 0 0 365 2L253,2A15 15 0 0 0 238 17A15 15 0 0 0 253 32Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="309" y="17" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="32" _mstTextHash="4549636">交易</text>
<polygon points="425,17 413,21 413,12" style="fill:rgb(0,0,0)"></polygon>
<path d="M380,17L419,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<circle cx="428" cy="17" r="3.6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></circle>
<path d="M83,70L104,70A15 15 0 0 0 119 55L119,55A15 15 0 0 0 104 39L83,39A15 15 0 0 0 68 55L68,55A15 15 0 0 0 83 70Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="94" y="55" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="33" _mstTextHash="5706649">结束</text>
<polygon points="68,55 56,59 56,50" style="fill:rgb(0,0,0)"></polygon>
<path d="M32,17 L 39,17 Q 47,17 47,32 L 47,40 Q 47,55 55,55 L 62,55" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="157,55 145,59 145,50" style="fill:rgb(0,0,0)"></polygon>
<path d="M119,55L151,55" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M157,55 L 164,55 Q 172,55 172,40 L 172,32 Q 172,17 179,17 L 187,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="309,47 297,51 297,43" style="fill:rgb(0,0,0)"></polygon>
<path d="M202,17 L 209,17 Q 217,17 217,32 L 217,32 Q 217,47 232,47 L 288,47 L 303,47" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M309,47 L 380,47 Q 395,47 395,32 L 395,32 Q 395,17 402,17 L 410,17" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
</svg>
</div>
</div>
<p><b><a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/syntax/rollback-stmt.html" _msttexthash="16073902" _msthash="95">回滚 stmt：</a></b>
<button id="x9ceee9d3" onclick="hideorshow(&quot;x9ceee9d3&quot;,&quot;xccc8a912&quot;)" _msttexthash="7070024" _msthash="96">隐藏</button></p>
 <div id="xccc8a912" class="imgcontainer">
 <div style="max-width:801px"><svg xmlns="http://www.w3.org/2000/svg" class="pikchr" viewBox="0 0 801.734 67.392" width="801.734" height="67.392">
<circle cx="5" cy="33" r="3.6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></circle>
<polygon points="32,33 20,38 20,29" style="fill:rgb(0,0,0)"></polygon>
<path d="M9,33L26,33" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M47,48L125,48A15 15 0 0 0 140 33A15 15 0 0 0 125 18L47,18A15 15 0 0 0 32 33A15 15 0 0 0 47 48Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="86" y="33" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="36" _mstTextHash="5770687">反转</text>
<polygon points="176,33 164,38 164,29" style="fill:rgb(0,0,0)"></polygon>
<path d="M140,33L170,33" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M191,48L303,48A15 15 0 0 0 318 33A15 15 0 0 0 303 18L191,18A15 15 0 0 0 176 33A15 15 0 0 0 191 48Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="247" y="33" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="37" _mstTextHash="4549636">交易</text>
<polygon points="390,33 378,38 378,29" style="fill:rgb(0,0,0)"></polygon>
<path d="M318,33L384,33" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M405,48L411,48A15 15 0 0 0 426 33A15 15 0 0 0 411 18L405,18A15 15 0 0 0 390 33A15 15 0 0 0 405 48Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="408" y="33" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="38" _mstTextHash="3026478">自</text>
<polygon points="462,33 450,38 450,29" style="fill:rgb(0,0,0)"></polygon>
<path d="M426,33L456,33" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M477,48L561,48A15 15 0 0 0 576 33A15 15 0 0 0 561 18L477,18A15 15 0 0 0 462 33A15 15 0 0 0 477 48Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="519" y="33" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="39" _mstTextHash="7668700">保存点</text>
<polygon points="612,33 601,38 601,29" style="fill:rgb(0,0,0)"></polygon>
<path d="M576,33L606,33" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M627,48L741,48A15 15 0 0 0 756 33A15 15 0 0 0 741 18L627,18A15 15 0 0 0 612 33A15 15 0 0 0 627 48Z" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<text x="684" y="33" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central" _mstHash="40" _mstTextHash="14929798">保存点名称</text>
<polygon points="792,33 780,38 780,29" style="fill:rgb(0,0,0)"></polygon>
<path d="M756,33L786,33" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<circle cx="795" cy="33" r="3.6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></circle>
<polygon points="519,6 507,10 507,2" style="fill:rgb(0,0,0)"></polygon>
<path d="M426,33 L 433,33 Q 441,33 441,20 Q 441,6 456,6 L 498,6 L 513,6" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M519,6 L 576,6 Q 591,6 591,20 Q 591,33 599,33 L 606,33" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="519,60 507,65 507,56" style="fill:rgb(0,0,0)"></polygon>
<path d="M352,33 L 359,33 Q 367,33 367,47 Q 367,60 382,60 L 498,60 L 513,60" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M519,60 L 756,60 Q 771,60 771,47 Q 771,33 778,33 L 786,33" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<polygon points="247,60 235,65 235,56" style="fill:rgb(0,0,0)"></polygon>
<path d="M140,33 L 147,33 Q 155,33 155,47 Q 155,60 170,60 L 226,60 L 241,60" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
<path d="M247,60 L 318,60 Q 333,60 333,47 Q 333,33 340,33 L 348,33" style="fill:none;stroke-width:2.16;stroke:rgb(0,0,0);"></path>
</svg>
</div>
</div>


<h1 id="transactions" _msttexthash="5761808" _msthash="97"><span _istranslated="1">2. </span>交易</h1>

<p _msttexthash="1386133034" _msthash="98">除事务外，不会发生任何读取或写入。
任何访问数据库的命令（基本上，任何 SQL 命令
除了一些 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/pragma.html#syntax" _istranslated="1">PRAGMA</a> 语句）
将自动开始交易，如果
一个尚未生效。自动启动的交易
在最后一个 SQL 语句完成时提交。</p>

<p _msttexthash="2211612065" _msthash="99">可以使用 BEGIN 手动启动事务
命令。此类事务通常会持续到下一次
COMMIT 或 ROLLBACK 命令。但交易也会
如果数据库已关闭或发生错误，则为 ROLLBACK
并指定了 ROLLBACK 冲突解决算法。
有关 ROLLBACK 的其他信息，请参阅有关 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_conflict.html" _istranslated="1">ON CONFLICT</a> 子句的文档
冲突解决算法。</p>

<p _msttexthash="39791323" _msthash="100">END TRANSACTION 是 COMMIT 的别名。</p>

<p _msttexthash="3647166224" _msthash="101">使用 BEGIN... 创建的事务COMMIT 不嵌套。
对于嵌套事务，请使用 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_savepoint.html" _istranslated="1">SAVEPOINT</a> 和 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_savepoint.html" _istranslated="1">RELEASE</a> 命令。
显示 ROLLBACK 命令的 “TO SAVEPOINT <span class="yyterm" _istranslated="1">name</span>” 子句
仅适用于 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_savepoint.html" _istranslated="1">SAVEPOINT</a> 事务。尝试在
事务将失败并显示错误，无论
事务由 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_savepoint.html" _istranslated="1">SAVEPOINT</a> 或之前的 BEGIN 启动。
不带 TO 子句的 COMMIT 命令和 ROLLBACK 命令
对 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_savepoint.html" _istranslated="1">SAVEPOINT</a> 事务的工作方式与对事务的工作方式相同
由 BEGIN 启动。</p>

<h2 id="read_transactions_versus_write_transactions" _msttexthash="38517661" _msthash="102"><span _istranslated="1">2.1. </span>读取事务与写入事务</h2>

<p _msttexthash="545454728" _msthash="103">SQLite 支持多个同时读取事务
来自不同的数据库连接，可能在单独的
线程或进程，但只有一个同时写入事务。</p><p>

</p><p _msttexthash="5828950348" _msthash="104">读取事务仅用于读取。写入事务
允许读取和写入。已启动读取事务
通过 SELECT 语句，写入事务由
CREATE、DELETE、DROP、INSERT 或 UPDATE 等语句（统称为
“write statements”） 的如果 write 语句发生在
读取事务处于活动状态，则读取事务将升级
如果可能，则写入事务。如果其他数据库连接
已修改数据库或正在执行
修改数据库，然后升级到写入事务是
不可能，并且 write 语句将失败，并显示 <a href="https://www.sqlite.org/rescode.html#busy" _istranslated="1">SQLITE_BUSY</a>。</p>

<p _msttexthash="4604044952" _msthash="105">当读取事务处于活动状态时，对数据库的任何更改
由单独的数据库连接实现的
通过启动 READ 事务的 Database CONNECTION。如果数据库
连接 X 持有一个读取事务，则某些
其他数据库连接 Y 可能会更改数据库的内容
当 X 的事务仍处于打开状态时，但 X 将无法看到
这些更改将持续到事务结束。当它读取时
交易处于活动状态，X 将继续看到
Y 实施的更改之前的数据库。</p>


<a name="immediate"></a>

<h2 id="deferred_immediate_and_exclusive_transactions" _msttexthash="33031193" _msthash="106"><span _istranslated="1">2.2. </span>DEFERRED、IMMEDIATE 和 EXCLUSIVE 事务</h2>

<p _msttexthash="151423571" _msthash="107">事务可以是 DEFERRED、IMMEDIATE 或 EXCLUSIVE。
默认事务行为为 DEFERRED。</p>

<p _msttexthash="6930146015" _msthash="108">DEFERRED 表示事务实际上不会
start 直到首次访问数据库。内部
BEGIN DEFERRED 语句仅在数据库上设置一个标志
connection 关闭通常
在最后一个语句结束时发生。这会导致事务
它会自动开始持续存在，直到显式的
COMMIT 或 ROLLBACK，或者直到错误引发回滚
或 ON CONFLICT ROLLBACK 子句。如果
BEGIN DEFERRED 是 SELECT，则启动读取事务。
后续的写入语句会将事务升级为
Write Transaction，或返回 SQLITE_BUSY。如果
BEGIN DEFERRED 之后的第一个语句是写入语句，则
将启动写入事务。</p>

<p _msttexthash="726832912" _msthash="109">IMMEDIATE 使数据库连接开始新的写入
，无需等待 write 语句。这
<a href="https://www.sqlite.org/rescode.html#busy" _istranslated="1">SQLITE_BUSY</a>如果再次写入
事务已在另一个数据库连接上处于活动状态。</p>

<p _msttexthash="1611181559" _msthash="110">EXCLUSIVE 与 IMMEDIATE 类似，因为写入事务
将立即启动。EXCLUSIVE 和 IMMEDIATE 是相同的
在 <a href="https://www.sqlite.org/wal.html" _istranslated="1">WAL 模式下</a>，但在其他日志模式下，EXCLUSIVE 会阻止
其他数据库连接读取数据库，而
交易正在进行中。</p>

<h2 id="implicit_versus_explicit_transactions" _msttexthash="41225808" _msthash="111"><span _istranslated="1">2.3. </span>隐式事务与显式事务</h2>

<p _msttexthash="4822133888" _msthash="112">隐式事务（自动启动的事务
不是由 BEGIN 启动的事务）在
最后一个活动语句完成。语句在其
last 游标关闭，这肯定会在
准备好的语句被<a href="https://www.sqlite.org/c3ref/reset.html" _istranslated="1">重置</a>或<a href="https://www.sqlite.org/c3ref/finalize.html" _istranslated="1">完成</a>。某些语句可能会 “finish”
为了在重置或最终确定之前进行交易控制，
但不能保证这一点。确保
statement has “finished” 是对该语句调用 <a href="https://www.sqlite.org/c3ref/reset.html" _istranslated="1">sqlite3_reset（）</a> 或 <a href="https://www.sqlite.org/c3ref/finalize.html" _istranslated="1">sqlite3_finalize（）。</a>用于 open <a href="https://www.sqlite.org/c3ref/blob.html" _istranslated="1">sqlite3_blob</a>
增量 BLOB I/O 也算作未完成的语句。
<a href="https://www.sqlite.org/c3ref/blob.html" _istranslated="1">sqlite3_blob</a> <a href="https://www.sqlite.org/c3ref/blob_close.html" _istranslated="1">在关闭</a>时完成。</p>

<p _msttexthash="727665289" _msthash="113">显式 COMMIT 命令会立即运行，即使存在
pending <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/lang_select.html" _istranslated="1">SELECT</a> 语句。但是，如果有待处理的
write作、COMMIT 命令
将失败，并显示错误代码 <a href="https://www.sqlite.org/rescode.html#busy" _istranslated="1">SQLITE_BUSY</a>。</p>

<p _msttexthash="1336249122" _msthash="114">尝试执行 COMMIT 也可能导致 <a href="https://www.sqlite.org/rescode.html#busy" _istranslated="1">SQLITE_BUSY</a> 返回代码
如果另一个线程或进程具有打开的读取连接。
当 COMMIT 在此
方式，事务保持活动状态，以后可以重试 COMMIT
在读者有机会清除之后。</p>

<p _msttexthash="5123480050" _msthash="115">在非常旧版本的 SQLite 中（版本 3.7.11 之前 - 2012-03-20）
如果有任何待处理的查询，则 ROLLBACK 将失败，并显示错误代码 <a href="https://www.sqlite.org/rescode.html#busy" _istranslated="1">SQLITE_BUSY</a>。在最近的
版本的 SQLite 中，ROLLBACK 将继续，待处理语句
通常会被中止，从而导致它们返回 <a href="https://www.sqlite.org/rescode.html#abort" _istranslated="1">SQLITE_ABORT</a> 或 <a href="https://www.sqlite.org/rescode.html#abort_rollback" _istranslated="1">SQLITE_ABORT_ROLLBACK</a> 错误。
在 SQLite 版本 3.8.8 （2015-01-16） 及更高版本中，
待处理读取将继续运行
只要 ROLLBACK 不修改数据库
图式。</p>

<p _msttexthash="393873064" _msthash="116">如果 <a href="file:///E:/Code/VsStudio/Jingan567/LcDataBaseCoverAll/SqliteTemplate/FileDocument/SQLite.NET/Core/pragma.html#pragma_journal_mode" _istranslated="1">PRAGMA journal_mode</a> 设置为 OFF（从而禁用回滚日志
file），则 ROLLBACK 命令的行为是 undefined。</p>

<h1 id="response_to_errors_within_a_transaction" _msttexthash="40277978" _msthash="117"><span _istranslated="1">3. </span>对事务中错误的响应</h1>

<p _msttexthash="487726668" _msthash="118">如果事务中发生某些类型的错误，
事务可能会也可能不会自动回滚。这
可能导致自动回滚的错误包括：</p>

<ul>
<li> <font _mstmutation="1" _msttexthash="78385567" _msthash="119"><a href="https://www.sqlite.org/rescode.html#full" _mstmutation="1" _istranslated="1">SQLITE_FULL</a>：数据库或磁盘已满</font></li><li> <font _mstmutation="1" _msttexthash="57199935" _msthash="120"><a href="https://www.sqlite.org/rescode.html#ioerr" _mstmutation="1" _istranslated="1">SQLITE_IOERR</a>：磁盘 I/O 错误</font></li><li> <font _mstmutation="1" _msttexthash="125006180" _msthash="121"><a href="https://www.sqlite.org/rescode.html#busy" _mstmutation="1" _istranslated="1">SQLITE_BUSY</a>：另一个进程正在使用的数据库</font></li><li> <font _mstmutation="1" _msttexthash="44653219" _msthash="122"><a href="https://www.sqlite.org/rescode.html#nomem" _mstmutation="1" _istranslated="1">SQLITE_NOMEM</a>：内存不足</font></li></ul>

<p _msttexthash="3217370585" _msthash="123">对于所有这些错误，SQLite 会尝试仅撤消一个语句
它正在处理 Leave 中先前语句的更改
相同的事务保持不变，并继续执行该事务。然而
取决于正在评估的语句以及
错误发生时，SQLite 可能需要回滚和
取消整个交易。应用程序可以判断是哪个
SQLite 使用 <a href="https://www.sqlite.org/c3ref/get_autocommit.html" _istranslated="1">sqlite3_get_autocommit（）</a> C 语言界面采取的行动方案。</p>

<p _msttexthash="889911633" _msthash="124">建议应用程序对错误做出响应
通过显式发出 ROLLBACK 命令。如果
事务已自动回滚
，则 ROLLBACK 命令将失败，并显示
错误，但不会因此造成任何伤害。</p>

<p _msttexthash="1563629769" _msthash="125">SQLite 的未来版本可能会扩展
可能会导致事务自动回滚。的未来版本
SQLite 可能会更改错误响应。特别是，我们可能会
选择通过以下方式简化 SQLite 未来版本中的界面
导致上述错误强制无条件回滚。</p>
<p align="center"><small><i _msttexthash="77563876" _msthash="126">此页面最后修改于 <a href="https://sqlite.org/docsrc/honeypot" id="mtimelink" data-href="https://sqlite.org/docsrc/finfo/pages/lang_transaction.in?m=9c5adbec23" _istranslated="1">2023-03-14 14：31：07</a> UTC</i></small></p>

</div></body></html>